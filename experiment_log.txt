=====train with torch DDP with fp32=====

Epoch [1/80]: 100%|██████████| 250/250 [00:44<00:00,  5.64it/s, loss=3.76]
Epoch [2/80]: 100%|██████████| 250/250 [00:42<00:00,  5.83it/s, loss=4.37]
Epoch [3/80]: 100%|██████████| 250/250 [00:42<00:00,  5.84it/s, loss=3.79]
Epoch [4/80]: 100%|██████████| 250/250 [00:42<00:00,  5.83it/s, loss=3.46]
Epoch [5/80]: 100%|██████████| 250/250 [00:43<00:00,  5.77it/s, loss=3.4]
Epoch [6/80]: 100%|██████████| 250/250 [00:43<00:00,  5.73it/s, loss=3.26]
Epoch [7/80]: 100%|██████████| 250/250 [00:42<00:00,  5.84it/s, loss=3.04]
Epoch [8/80]: 100%|██████████| 250/250 [00:42<00:00,  5.87it/s, loss=3.28]
Epoch [9/80]: 100%|██████████| 250/250 [00:42<00:00,  5.83it/s, loss=3.14]
Epoch [10/80]: 100%|██████████| 250/250 [00:42<00:00,  5.82it/s, loss=3.06]
Epoch [11/80]: 100%|██████████| 250/250 [00:43<00:00,  5.73it/s, loss=2.66]
Epoch [12/80]: 100%|██████████| 250/250 [00:43<00:00,  5.77it/s, loss=2.72]
Epoch [13/80]: 100%|██████████| 250/250 [00:42<00:00,  5.85it/s, loss=2.59]
Epoch [14/80]: 100%|██████████| 250/250 [00:42<00:00,  5.83it/s, loss=2.67]
Epoch [15/80]: 100%|██████████| 250/250 [00:42<00:00,  5.87it/s, loss=2.47]
Epoch [16/80]: 100%|██████████| 250/250 [00:43<00:00,  5.71it/s, loss=2.52]
Epoch [17/80]: 100%|██████████| 250/250 [00:42<00:00,  5.86it/s, loss=2.23]
Epoch [18/80]: 100%|██████████| 250/250 [00:42<00:00,  5.85it/s, loss=2.13]
Epoch [19/80]: 100%|██████████| 250/250 [00:42<00:00,  5.86it/s, loss=2.45]
Epoch [20/80]: 100%|██████████| 250/250 [00:43<00:00,  5.79it/s, loss=2.06]
Epoch [21/80]: 100%|██████████| 250/250 [00:43<00:00,  5.72it/s, loss=1.86]
Epoch [22/80]: 100%|██████████| 250/250 [00:42<00:00,  5.86it/s, loss=1.78]
Epoch [23/80]: 100%|██████████| 250/250 [00:42<00:00,  5.87it/s, loss=1.63]
Epoch [24/80]: 100%|██████████| 250/250 [00:43<00:00,  5.80it/s, loss=1.48]
Epoch [25/80]: 100%|██████████| 250/250 [00:42<00:00,  5.83it/s, loss=1.56]
Epoch [26/80]: 100%|██████████| 250/250 [00:43<00:00,  5.73it/s, loss=1.28]
Epoch [27/80]: 100%|██████████| 250/250 [00:42<00:00,  5.85it/s, loss=1.1]
Epoch [28/80]: 100%|██████████| 250/250 [00:43<00:00,  5.79it/s, loss=0.926]
Epoch [29/80]: 100%|██████████| 250/250 [00:42<00:00,  5.82it/s, loss=0.654]
Epoch [30/80]: 100%|██████████| 250/250 [00:42<00:00,  5.86it/s, loss=0.523]
Epoch [31/80]: 100%|██████████| 250/250 [00:43<00:00,  5.70it/s, loss=0.381]
Epoch [32/80]: 100%|██████████| 250/250 [00:43<00:00,  5.77it/s, loss=0.539]
Epoch [33/80]: 100%|██████████| 250/250 [00:42<00:00,  5.87it/s, loss=0.239]
Epoch [34/80]: 100%|██████████| 250/250 [00:42<00:00,  5.84it/s, loss=0.311]
Epoch [35/80]: 100%|██████████| 250/250 [00:42<00:00,  5.82it/s, loss=0.308]
Epoch [36/80]: 100%|██████████| 250/250 [00:44<00:00,  5.67it/s, loss=0.301]
Epoch [37/80]: 100%|██████████| 250/250 [00:42<00:00,  5.83it/s, loss=0.306]
Epoch [38/80]: 100%|██████████| 250/250 [00:42<00:00,  5.83it/s, loss=0.28]
Epoch [39/80]: 100%|██████████| 250/250 [00:42<00:00,  5.82it/s, loss=0.25]
Epoch [40/80]: 100%|██████████| 250/250 [00:43<00:00,  5.79it/s, loss=0.197]
Epoch [41/80]: 100%|██████████| 250/250 [00:44<00:00,  5.67it/s, loss=0.113]
Epoch [42/80]: 100%|██████████| 250/250 [00:43<00:00,  5.81it/s, loss=0.129]
Epoch [43/80]: 100%|██████████| 250/250 [00:43<00:00,  5.81it/s, loss=0.0836]
Epoch [44/80]: 100%|██████████| 250/250 [00:43<00:00,  5.72it/s, loss=0.115]
Epoch [45/80]: 100%|██████████| 250/250 [00:43<00:00,  5.81it/s, loss=0.0691]
Epoch [46/80]: 100%|██████████| 250/250 [00:43<00:00,  5.72it/s, loss=0.0603]
Epoch [47/80]: 100%|██████████| 250/250 [00:43<00:00,  5.81it/s, loss=0.0551]
Epoch [48/80]: 100%|██████████| 250/250 [00:43<00:00,  5.80it/s, loss=0.0652]
Epoch [49/80]: 100%|██████████| 250/250 [00:42<00:00,  5.84it/s, loss=0.09]
Epoch [50/80]: 100%|██████████| 250/250 [00:43<00:00,  5.79it/s, loss=0.0458]
Epoch [51/80]: 100%|██████████| 250/250 [00:43<00:00,  5.69it/s, loss=0.0474]
Epoch [52/80]: 100%|██████████| 250/250 [00:42<00:00,  5.84it/s, loss=0.0302]
Epoch [53/80]: 100%|██████████| 250/250 [00:43<00:00,  5.79it/s, loss=0.0298]
Epoch [54/80]: 100%|██████████| 250/250 [00:43<00:00,  5.81it/s, loss=0.0514]
Epoch [55/80]: 100%|██████████| 250/250 [00:43<00:00,  5.80it/s, loss=0.0386]
Epoch [56/80]: 100%|██████████| 250/250 [00:43<00:00,  5.72it/s, loss=0.0249]
Epoch [57/80]: 100%|██████████| 250/250 [00:43<00:00,  5.74it/s, loss=0.0365]
Epoch [58/80]: 100%|██████████| 250/250 [00:43<00:00,  5.81it/s, loss=0.0696]
Epoch [59/80]: 100%|██████████| 250/250 [00:43<00:00,  5.81it/s, loss=0.0318]
Epoch [60/80]: 100%|██████████| 250/250 [00:42<00:00,  5.83it/s, loss=0.0285]
Epoch [61/80]: 100%|██████████| 250/250 [00:44<00:00,  5.68it/s, loss=0.0265]
Epoch [62/80]: 100%|██████████| 250/250 [00:42<00:00,  5.84it/s, loss=0.0115]
Epoch [63/80]: 100%|██████████| 250/250 [00:42<00:00,  5.83it/s, loss=0.0167]
Epoch [64/80]: 100%|██████████| 250/250 [00:42<00:00,  5.83it/s, loss=0.0211]
Epoch [65/80]: 100%|██████████| 250/250 [00:43<00:00,  5.79it/s, loss=0.0157]
Epoch [66/80]: 100%|██████████| 250/250 [00:43<00:00,  5.69it/s, loss=0.0155]
Epoch [67/80]: 100%|██████████| 250/250 [00:43<00:00,  5.77it/s, loss=0.0128]
Epoch [68/80]: 100%|██████████| 250/250 [00:43<00:00,  5.81it/s, loss=0.0149]
Epoch [69/80]: 100%|██████████| 250/250 [00:43<00:00,  5.80it/s, loss=0.028]
Epoch [70/80]: 100%|██████████| 250/250 [00:43<00:00,  5.81it/s, loss=0.0149]
Epoch [71/80]: 100%|██████████| 250/250 [00:44<00:00,  5.64it/s, loss=0.0111]
Epoch [72/80]: 100%|██████████| 250/250 [00:42<00:00,  5.84it/s, loss=0.00988]
Epoch [73/80]: 100%|██████████| 250/250 [00:42<00:00,  5.84it/s, loss=0.00872]
Epoch [74/80]: 100%|██████████| 250/250 [00:43<00:00,  5.81it/s, loss=0.018]
Epoch [75/80]: 100%|██████████| 250/250 [00:43<00:00,  5.77it/s, loss=0.00643]
Epoch [76/80]: 100%|██████████| 250/250 [00:43<00:00,  5.72it/s, loss=0.0141]
Epoch [77/80]: 100%|██████████| 250/250 [00:42<00:00,  5.82it/s, loss=0.0161]
Epoch [78/80]: 100%|██████████| 250/250 [00:43<00:00,  5.77it/s, loss=0.00778]
Epoch [79/80]: 100%|██████████| 250/250 [00:43<00:00,  5.76it/s, loss=0.00572]
Epoch [80/80]: 100%|██████████| 250/250 [00:43<00:00,  5.79it/s, loss=0.00565]
Accuracy of the model on the test images: 41.00 %

====== Training on All Nodes =====
127.0.0.1: success

====== Stopping All Nodes =====
127.0.0.1: finish


=====train with torch DDP with fp16=====
Epoch [1/80]: 100%|██████████| 250/250 [00:29<00:00,  8.47it/s, loss=3.84]
Epoch [2/80]: 100%|██████████| 250/250 [00:27<00:00,  9.06it/s, loss=4.57]
Epoch [3/80]: 100%|██████████| 250/250 [00:27<00:00,  9.13it/s, loss=3.8]
Epoch [4/80]: 100%|██████████| 250/250 [00:27<00:00,  9.04it/s, loss=3.43]
Epoch [5/80]: 100%|██████████| 250/250 [00:27<00:00,  8.97it/s, loss=3.26]
Epoch [6/80]: 100%|██████████| 250/250 [00:28<00:00,  8.69it/s, loss=3.04]
Epoch [7/80]: 100%|██████████| 250/250 [00:27<00:00,  8.99it/s, loss=3.14]
Epoch [8/80]: 100%|██████████| 250/250 [00:27<00:00,  9.08it/s, loss=2.88]
Epoch [9/80]: 100%|██████████| 250/250 [00:27<00:00,  9.02it/s, loss=2.78]
Epoch [10/80]: 100%|██████████| 250/250 [00:27<00:00,  8.95it/s, loss=2.85]
Epoch [11/80]: 100%|██████████| 250/250 [00:28<00:00,  8.72it/s, loss=2.49]
Epoch [12/80]: 100%|██████████| 250/250 [00:27<00:00,  9.13it/s, loss=2.39]
Epoch [13/80]: 100%|██████████| 250/250 [00:27<00:00,  9.09it/s, loss=2.22]
Epoch [14/80]: 100%|██████████| 250/250 [00:27<00:00,  9.13it/s, loss=2.16]
Epoch [15/80]: 100%|██████████| 250/250 [00:27<00:00,  9.11it/s, loss=2.12]
Epoch [16/80]: 100%|██████████| 250/250 [00:28<00:00,  8.75it/s, loss=1.9]
Epoch [17/80]: 100%|██████████| 250/250 [00:27<00:00,  8.99it/s, loss=1.8]
Epoch [18/80]: 100%|██████████| 250/250 [00:27<00:00,  8.94it/s, loss=1.69]
Epoch [19/80]: 100%|██████████| 250/250 [00:27<00:00,  9.11it/s, loss=1.64]
Epoch [20/80]: 100%|██████████| 250/250 [00:28<00:00,  8.93it/s, loss=1.46]
Epoch [21/80]: 100%|██████████| 250/250 [00:28<00:00,  8.72it/s, loss=1.34]
Epoch [22/80]: 100%|██████████| 250/250 [00:27<00:00,  9.05it/s, loss=1.18]
Epoch [23/80]: 100%|██████████| 250/250 [00:27<00:00,  8.95it/s, loss=1.03]
Epoch [24/80]: 100%|██████████| 250/250 [00:28<00:00,  8.80it/s, loss=0.877]
Epoch [25/80]: 100%|██████████| 250/250 [00:28<00:00,  8.65it/s, loss=0.853]
Epoch [26/80]: 100%|██████████| 250/250 [00:29<00:00,  8.50it/s, loss=0.814]
Epoch [27/80]: 100%|██████████| 250/250 [00:27<00:00,  8.98it/s, loss=0.716]
Epoch [28/80]: 100%|██████████| 250/250 [00:28<00:00,  8.89it/s, loss=0.641]
Epoch [29/80]: 100%|██████████| 250/250 [00:28<00:00,  8.90it/s, loss=0.46]
Epoch [30/80]: 100%|██████████| 250/250 [00:28<00:00,  8.93it/s, loss=0.479]
Epoch [31/80]: 100%|██████████| 250/250 [00:29<00:00,  8.39it/s, loss=0.419]
Epoch [32/80]: 100%|██████████| 250/250 [00:28<00:00,  8.90it/s, loss=0.351]
Epoch [33/80]: 100%|██████████| 250/250 [00:28<00:00,  8.91it/s, loss=0.393]
Epoch [34/80]: 100%|██████████| 250/250 [00:27<00:00,  8.99it/s, loss=0.339]
Epoch [35/80]: 100%|██████████| 250/250 [00:27<00:00,  9.01it/s, loss=0.299]
Epoch [36/80]: 100%|██████████| 250/250 [00:29<00:00,  8.56it/s, loss=0.288]
Epoch [37/80]: 100%|██████████| 250/250 [00:28<00:00,  8.78it/s, loss=0.191]
Epoch [38/80]: 100%|██████████| 250/250 [00:27<00:00,  8.93it/s, loss=0.213]
Epoch [39/80]: 100%|██████████| 250/250 [00:27<00:00,  9.00it/s, loss=0.208]
Epoch [40/80]: 100%|██████████| 250/250 [00:27<00:00,  8.93it/s, loss=0.206]
Epoch [41/80]: 100%|██████████| 250/250 [00:29<00:00,  8.60it/s, loss=0.134]
Epoch [42/80]: 100%|██████████| 250/250 [00:28<00:00,  8.91it/s, loss=0.163]
Epoch [43/80]: 100%|██████████| 250/250 [00:27<00:00,  8.95it/s, loss=0.0726]
Epoch [44/80]: 100%|██████████| 250/250 [00:28<00:00,  8.80it/s, loss=0.0652]
Epoch [45/80]: 100%|██████████| 250/250 [00:28<00:00,  8.85it/s, loss=0.068]
Epoch [46/80]: 100%|██████████| 250/250 [00:29<00:00,  8.59it/s, loss=0.085]
Epoch [47/80]: 100%|██████████| 250/250 [00:27<00:00,  8.94it/s, loss=0.056]
Epoch [48/80]: 100%|██████████| 250/250 [00:28<00:00,  8.92it/s, loss=0.0615]
Epoch [49/80]: 100%|██████████| 250/250 [00:27<00:00,  8.96it/s, loss=0.0753]
Epoch [50/80]: 100%|██████████| 250/250 [00:28<00:00,  8.84it/s, loss=0.0389]
Epoch [51/80]: 100%|██████████| 250/250 [00:29<00:00,  8.55it/s, loss=0.0454]
Epoch [52/80]: 100%|██████████| 250/250 [00:28<00:00,  8.84it/s, loss=0.0468]
Epoch [53/80]: 100%|██████████| 250/250 [00:28<00:00,  8.77it/s, loss=0.0459]
Epoch [54/80]: 100%|██████████| 250/250 [00:28<00:00,  8.89it/s, loss=0.0591]
Epoch [55/80]: 100%|██████████| 250/250 [00:28<00:00,  8.81it/s, loss=0.0552]
Epoch [56/80]: 100%|██████████| 250/250 [00:30<00:00,  8.27it/s, loss=0.0288]
Epoch [57/80]: 100%|██████████| 250/250 [00:28<00:00,  8.74it/s, loss=0.0314]
Epoch [58/80]: 100%|██████████| 250/250 [00:27<00:00,  8.94it/s, loss=0.055]
Epoch [59/80]: 100%|██████████| 250/250 [00:27<00:00,  8.93it/s, loss=0.035]
Epoch [60/80]: 100%|██████████| 250/250 [00:27<00:00,  8.97it/s, loss=0.0481]
Epoch [61/80]: 100%|██████████| 250/250 [00:28<00:00,  8.65it/s, loss=0.0184]
Epoch [62/80]: 100%|██████████| 250/250 [00:28<00:00,  8.84it/s, loss=0.0235]
Epoch [63/80]: 100%|██████████| 250/250 [00:28<00:00,  8.78it/s, loss=0.0196]
Epoch [64/80]: 100%|██████████| 250/250 [00:28<00:00,  8.90it/s, loss=0.0315]
Epoch [65/80]: 100%|██████████| 250/250 [00:28<00:00,  8.90it/s, loss=0.0226]
Epoch [66/80]: 100%|██████████| 250/250 [00:29<00:00,  8.61it/s, loss=0.0264]
Epoch [67/80]: 100%|██████████| 250/250 [00:28<00:00,  8.85it/s, loss=0.015]
Epoch [68/80]: 100%|██████████| 250/250 [00:28<00:00,  8.83it/s, loss=0.0227]
Epoch [69/80]: 100%|██████████| 250/250 [00:28<00:00,  8.69it/s, loss=0.0196]
Epoch [70/80]: 100%|██████████| 250/250 [00:28<00:00,  8.85it/s, loss=0.0258]
Epoch [71/80]: 100%|██████████| 250/250 [00:29<00:00,  8.61it/s, loss=0.018]
Epoch [72/80]: 100%|██████████| 250/250 [00:28<00:00,  8.88it/s, loss=0.015]
Epoch [73/80]: 100%|██████████| 250/250 [00:27<00:00,  8.97it/s, loss=0.0235]
Epoch [74/80]: 100%|██████████| 250/250 [00:28<00:00,  8.84it/s, loss=0.0144]
Epoch [75/80]: 100%|██████████| 250/250 [00:28<00:00,  8.79it/s, loss=0.0211]
Epoch [76/80]: 100%|██████████| 250/250 [00:29<00:00,  8.50it/s, loss=0.0155]
Epoch [77/80]: 100%|██████████| 250/250 [00:28<00:00,  8.84it/s, loss=0.0278]
Epoch [78/80]: 100%|██████████| 250/250 [00:28<00:00,  8.70it/s, loss=0.0209]
Epoch [79/80]: 100%|██████████| 250/250 [00:28<00:00,  8.77it/s, loss=0.0664]
Epoch [80/80]: 100%|██████████| 250/250 [00:28<00:00,  8.87it/s, loss=0.0133]
Accuracy of the model on the test images: 45.53 %

====== Training on All Nodes =====
127.0.0.1: success

====== Stopping All Nodes =====
127.0.0.1: finish